<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36" version="29.5.1">
  <diagram name="Promtior Flow" id="promtior-s2-fixed">
    <mxGraphModel dx="983" dy="536" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="900" pageHeight="700" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" parent="1" style="text;strokeColor=none;fillColor=none;align=center;fontSize=18;fontStyle=1;fontColor=#1E1B4B;" value="Promtior RAG Chatbot — Request Flow" vertex="1">
          <mxGeometry height="30" width="700" x="100" y="20" as="geometry" />
        </mxCell>
        <mxCell id="user" parent="1" style="rounded=1;fillColor=#EDE9FE;strokeColor=#7C3AED;fontSize=13;fontStyle=1;" value="User" vertex="1">
          <mxGeometry height="50" width="110" x="40" y="230" as="geometry" />
        </mxCell>
        <mxCell id="api" parent="1" style="rounded=1;fillColor=#EDE9FE;strokeColor=#8B5CF6;fontSize=13;fontStyle=1;" value="FastAPI&#xa;+ LangServe" vertex="1">
          <mxGeometry height="60" width="120" x="210" y="280" as="geometry" />
        </mxCell>
        <mxCell id="rag" parent="1" style="rounded=1;fillColor=#D1FAE5;strokeColor=#10B981;fontSize=13;fontStyle=1;" value="RAG Chain" vertex="1">
          <mxGeometry height="60" width="120" x="410" y="280" as="geometry" />
        </mxCell>
        <mxCell id="cache" parent="1" style="rounded=1;fillColor=#E0F2FE;strokeColor=#0EA5E9;fontSize=13;fontStyle=1;" value="Cache&#xa;(10 min TTL)" vertex="1">
          <mxGeometry height="60" width="140" x="620" y="140" as="geometry" />
        </mxCell>
        <mxCell id="docs" parent="1" style="rounded=1;fillColor=#FFEDD5;strokeColor=#F97316;fontSize=13;fontStyle=1;" value="Document Store&#xa;(keyword search)" vertex="1">
          <mxGeometry height="60" width="150" x="620" y="280" as="geometry" />
        </mxCell>
        <mxCell id="groq" parent="1" style="rounded=1;fillColor=#FEE2E2;strokeColor=#EF4444;fontSize=13;fontStyle=1;" value="Groq API&#xa;(LLM)" vertex="1">
          <mxGeometry height="60" width="140" x="620" y="430" as="geometry" />
        </mxCell>
        <mxCell id="e1" edge="1" parent="1" source="user" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#7C3AED;strokeWidth=2;fontSize=11;fontColor=#6D28D9;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" target="api" value="① question">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2" edge="1" parent="1" source="api" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#8B5CF6;strokeWidth=2;fontSize=11;fontColor=#6D28D9;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" target="rag" value="② invoke">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e3" edge="1" parent="1" source="rag" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#0EA5E9;strokeWidth=2;fontSize=11;fontColor=#0369A1;exitX=0.5;exitY=0;entryX=0.5;entryY=1;" target="cache" value="③ check cache">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e4a" edge="1" parent="1" source="cache" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#0EA5E9;strokeWidth=2;dashed=1;fontSize=11;fontColor=#0369A1;exitX=0;exitY=0.5;entryX=0.5;entryY=0;" target="api" value="④A HIT (PATH A)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="470" y="170" />
              <mxPoint x="270" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e4b" edge="1" parent="1" source="cache" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#F97316;strokeWidth=2;fontSize=11;fontColor=#C2410C;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" target="docs" value="④B MISS (PATH B)">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e5" edge="1" parent="1" source="docs" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#F97316;strokeWidth=2;fontSize=11;fontColor=#C2410C;exitX=0;exitY=0.5;entryX=1;entryY=0.5;" target="rag" value="⑤ top 4 chunks">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6" edge="1" parent="1" style="strokeColor=#EF4444;strokeWidth=2;fontSize=11;fontColor=#B91C1C;exitX=0.547;exitY=1.055;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;endArrow=blockThin;endFill=1;" value="⑥ prompt + context">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="461" y="460" />
              <mxPoint x="563" y="460" />
              <mxPoint x="563" y="464" />
              <mxPoint x="603" y="464" />
            </Array>
            <mxPoint x="461.01999999999987" y="342.00000000000006" as="sourcePoint" />
            <mxPoint x="620" y="464" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="e7" edge="1" parent="1" source="groq" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#EF4444;strokeWidth=2;fontSize=11;fontColor=#B91C1C;exitX=0.5;exitY=0;entryX=1;entryY=0.8;exitDx=0;exitDy=0;" target="rag" value="⑦ LLM answer">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="690" y="356" />
              <mxPoint x="530" y="356" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e7s" edge="1" parent="1" source="rag" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#0EA5E9;dashed=1;strokeWidth=1;fontSize=11;fontColor=#0369A1;exitX=0.5;exitY=0;entryX=0;entryY=1;" target="cache" value="⑦ save to cache">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="560" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="legbg" parent="1" style="rounded=1;fillColor=#F8FAFC;strokeColor=#CBD5E1;" value="" vertex="1">
          <mxGeometry height="110" width="800" x="40" y="560" as="geometry" />
        </mxCell>
        <mxCell id="l0" parent="1" style="text;strokeColor=none;fillColor=none;align=left;fontSize=11;fontColor=#0369A1;" value="PATH A  (① ② ③ ④A ⑧)   Cache HIT: answer cached &lt; 10 min → Groq not called, response instant" vertex="1">
          <mxGeometry height="20" width="760" x="60" y="572" as="geometry" />
        </mxCell>
        <mxCell id="l1" parent="1" style="text;strokeColor=none;fillColor=none;align=left;fontSize=11;fontColor=#B91C1C;" value="PATH B  (① ② ③ ④B ⑤ ⑥ ⑦ ⑧)   Cache MISS: search docs → call Groq → RAG saves to cache → return answer" vertex="1">
          <mxGeometry height="20" width="760" x="60" y="596" as="geometry" />
        </mxCell>
        <mxCell id="l2" parent="1" style="text;strokeColor=none;fillColor=none;align=left;fontSize=11;fontColor=#475569;" value="solid arrow = request flow     dashed blue = cache shortcut or save     green arrow = final response to user" vertex="1">
          <mxGeometry height="20" width="760" x="60" y="622" as="geometry" />
        </mxCell>
        <mxCell id="l3" parent="1" style="text;strokeColor=none;fillColor=none;align=left;fontSize=10;fontColor=#94A3B8;" value="Note: Document Store only searches chunks. Cache is written by RAG Chain after receiving Groq&#39;s response." vertex="1">
          <mxGeometry height="18" width="760" x="60" y="648" as="geometry" />
        </mxCell>
        <mxCell id="qjMolJy-sXRqeNrXrcoT-1" edge="1" parent="1" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#005700;strokeWidth=2;fontSize=11;fontColor=light-dark(#6D28D9,#00FF00);exitX=0.5;exitY=1;entryX=0.5;entryY=1;exitDx=0;exitDy=0;entryDx=0;entryDy=0;fillColor=#008a00;" value="⑧ answer shown in chat">
          <mxGeometry relative="1" x="-0.1072" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="271" y="451" />
              <mxPoint x="96" y="451" />
            </Array>
            <mxPoint x="271" y="340.0000000000001" as="sourcePoint" />
            <mxPoint x="96" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
